<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Certificate Generator ‚Äî Frontend Developer Course</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  /* =========================
     THEME VARIABLES
  ========================== */
  :root{
    --primary:#4da3ff;
    --secondary:#d4af37;
    --paper:#0b1c2d;          /* deep navy */
    --paper-alt:#102a43;      /* slightly lighter navy */
    --text-main:#e6f0ff;
    --text-muted:#9fb3c8;
  }

  /* =========================
     BASE PAGE
  ========================== */
  body{
    background:#0f172a;
    color:#e5e7eb;
    font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
  }

  pre{
    font-size:12px;
    color:#475569;
  }

  /* =========================
     CERTIFICATE CARD
  ========================== */
  .card-certificate{
    background:linear-gradient(180deg,var(--paper),var(--paper-alt));
    border:8px double rgba(212,175,55,0.35);
    padding:36px;
    border-radius:14px;
    position:relative;
    overflow:hidden;
    color:var(--text-main);
    box-shadow:0 25px 60px rgba(0,0,0,0.55);
  }

  /* =========================
     BACKGROUND PATTERN
  ========================== */
  .guilloche{
    position:absolute;
    inset:0;
    opacity:0.15;
    pointer-events:none;
    background-image:
      radial-gradient(rgba(255,255,255,0.08) 1px, transparent 1px);
    background-size:26px 26px;
  }

  /* =========================
     LOGO
  ========================== */
  .logo-circle{
    width:72px;
    height:72px;
    border-radius:50%;
    background:rgba(77,163,255,0.15);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:34px;
    color:#7cc4ff;
    box-shadow:0 0 0 6px rgba(77,163,255,0.08);
  }

  /* =========================
     HEADINGS & TEXT
  ========================== */
  .card-certificate h1,
  .card-certificate h3,
  .card-certificate h4{
    color:#f8fafc;
  }

  .card-certificate .text-muted{
    color:var(--text-muted) !important;
  }

  .card-certificate hr{
    border-color:rgba(212,175,55,0.6);
  }

  /* =========================
     SIGNATURE
  ========================== */
  .signature{
    font-family:'Georgia',serif;
    font-size:34px;
    color:#f5e6b3;
  }

  /* gold divider lines inside certificate */
  .card-certificate div[style*="background:#cbd5e1"]{
    background:rgba(212,175,55,0.6) !important;
  }

  /* =========================
     BUTTONS (minor polish)
  ========================== */
  .btn-primary{
    background:#2563eb;
    border-color:#2563eb;
  }

  .btn-primary:hover{
    background:#1d4ed8;
    border-color:#1d4ed8;
  }
  .logo-circle img{
  width:100%;
  height:100%;
  object-fit:contain;
  border-radius:50%;
  background:#fff;
}

  /* =========================
     PRINT STYLES
  ========================== */
  @media print{
    body{
      background:#fff !important;
      color:#000 !important;
    }

    body *{
      visibility:hidden;
    }

    .card-certificate,
    .card-certificate *{
      visibility:visible;
    }

    .card-certificate{
      position:absolute;
      left:0;
      top:0;
      width:100%;
      box-shadow:none;
      border-color:#bfa14a;
    }
  }
</style>

</head>
<body>
  <div class="container py-5">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="p-3 bg-white rounded shadow-sm">
          <h5>Create certificate</h5>
          <p class="text-muted small">Fill the form and click <strong>Generate</strong>.</p>
          <form id="certForm" onsubmit="return false">
            <div class="mb-2">
              <label class="form-label small">Platform name</label>
              <input id="platform" class="form-control form-control-sm" placeholder="Apex Academy">
            </div>
            <div class="mb-2">
              <label class="form-label small">Logo URL (optional)</label>
              <input id="logo" class="form-control form-control-sm" placeholder="https://.../logo.png">
            </div>
            <div class="mb-2">
              <label class="form-label small">Instructor</label>
              <input id="instructor" class="form-control form-control-sm" placeholder="Dr. Jane Doe">
            </div>
            <div class="mb-2">
              <label class="form-label small">Student</label>
              <input id="student" class="form-control form-control-sm" placeholder="Alex Morgan">
            </div>
            <div class="mb-2">
              <label class="form-label small">Course name</label>
              <input id="course" class="form-control form-control-sm" placeholder="Frontend Developer ‚Äî Advanced">
            </div>
            <div class="mb-2">
              <label class="form-label small">Date</label>
              <input id="date" class="form-control form-control-sm" placeholder="October 24, 2025">
            </div>

            <div class="d-flex gap-2 mt-2">
              <button id="generateBtn" type="button" class="btn btn-primary btn-sm flex-fill">Generate</button>
              <button id="saveBtn" type="button" class="btn btn-outline-secondary btn-sm flex-fill">Save</button>
            </div>
          </form>
        </div>

        <div class="mt-3 p-3 bg-white rounded shadow-sm">
          <h6>Saved certificates</h6>
          <p class="small text-muted">Click an item to preview it.</p>
          <ul id="savedList" class="list-group list-group-flush" style="max-height:260px;overflow:auto"></ul>
          <div class="mt-2 d-grid">
            <button id="clearStorage" type="button" class="btn btn-danger btn-sm">Clear all</button>
          </div>
        </div>

        <div class="mt-3 p-3 bg-white rounded shadow-sm small text-muted">
          <p><strong>Data structure</strong></p>
          <pre>const certificates = [{ platform, logo, instructor, student, course, date }]</pre>
        </div>
      </div>

      <div class="col-md-8">
        <div class="d-flex justify-content-end mb-3 gap-2">
          <button id="downloadPdf" type="button" class="btn btn-primary btn-sm"><span class="me-1">‚¨áÔ∏è</span> Download PDF</button>
          <button id="printBtn" type="button" class="btn btn-outline-secondary btn-sm">üñ®Ô∏è Print</button>
        </div>

        <div id="certificateCard" class="card-certificate mb-3">
          <div class="guilloche"></div>
          <div class="text-center">
            <div id="logoImg" class="logo-circle mx-auto mb-2">
              <!-- <span id="logoIcon">üè´</span> -->
               <img src="https://bf405b85al.ufs.sh/f/PjFaqcYM62U3EbVQvu62Cn8XSKN9FrtBE5VHx1IvPbq7flwT" alt="" id="logoIcon">
            </div>
            <h3 id="platformTitle" class="mb-1 text-uppercase">Academy/Dennis-Digital-Hub</h3>
            <hr style="width:120px;border-top:3px solid var(--secondary);margin:8px auto 20px">

            <p class="small text-muted mb-1">Certificate of Completion</p>
            <p class="small text-muted fst-italic">This is to certify that</p>

            <h1 id="studentName" class="text-secondary" style="font-family:'Georgia',serif;font-size:40px;margin:12px 0">Joheobe Jaden Ominyi</h1>
            <div style="height:2px;width:200px;background:#e2e8f0;margin:8px auto"></div>

            <p class="small text-muted mt-3 mb-1">has successfully completed the course</p>
            <h4 id="courseName" class="mb-3">Frontend Web Developement</h4>

            <div class="row mt-4">
              <div class="col-6 text-center">
                <div id="instructorSign" class="signature">Dennis Lovelyn</div>
                <div style="height:1px;background:#cbd5e1;margin:8px 0"></div>
                <div class="small text-muted">Instructor</div>
              </div>
              <div class="col-6 text-center">
                <div id="issueDate" class="mb-2">January 12, 2026</div>
                <div style="height:1px;background:#cbd5e1;margin:8px 0"></div>
                <div class="small text-muted">Date Issued</div>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-end mt-4">
              <div class="small text-muted">ID: CRT-2026-0001-FE</div>
              <div class="small text-muted"> 
                <a href="http://127.0.0.1:5500/verify.html?cert=CRT-2026-0001-FE" style="text-decoration: none;">Verify Certificate</a> 
              <!-- <a href="https://digital-services-virid.vercel.app/verify.html?cert=CRT-2026-0001-FE">Verify Certificate</a> -->
              </div>
            </div>
          </div>
        </div>

        <div id="printContainer" style="display:none"></div>
      </div>
    </div>
  </div>

  <!-- html2pdf for download -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <!-- Bootstrap bundle (optional JS) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
window.addEventListener('DOMContentLoaded', () => {
  try {
    console.log('certificate script loaded');

    // Data store
    const STORAGE_KEY = 'certificates_v1';
    let certificates = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    // DOM references
    const platformEl = document.getElementById('platform');
    const logoEl = document.getElementById('logo');
    const instructorEl = document.getElementById('instructor');
    const studentEl = document.getElementById('student');
    const courseEl = document.getElementById('course');
    const dateEl = document.getElementById('date');

    const generateBtn = document.getElementById('generateBtn');
    const saveBtn = document.getElementById('saveBtn');
    const savedList = document.getElementById('savedList');
    const clearStorage = document.getElementById('clearStorage');

    const platformTitle = document.getElementById('platformTitle');
    const logoWrap = document.getElementById('logoImg');
    const studentName = document.getElementById('studentName');
    const courseName = document.getElementById('courseName');
    const instructorSign = document.getElementById('instructorSign');
    const issueDate = document.getElementById('issueDate');
    const certificateCard = document.getElementById('certificateCard');

    function escapeHtml(str){
      if(!str) return '';
      return String(str)
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;')
        .replace(/'/g,'&#39;');
    }

    function renderCertificate(data){
      platformTitle.textContent = data.platform || 'Platform Name';
      studentName.textContent = data.student || 'Recipient Name';
      courseName.textContent = data.course || 'Course Title';
      instructorSign.textContent = data.instructor || 'Instructor';
      issueDate.textContent = data.date || new Date().toLocaleDateString();

      // logo handling
      if (data.logo){
        logoWrap.innerHTML = '';
        const img = document.createElement('img');
        img.src = data.logo;
        img.alt = data.platform || 'logo';
        img.style.width = '100%'; img.style.height = '100%'; img.style.objectFit='cover';
        img.onerror = () => { logoWrap.innerHTML = '<span id="logoIcon">üè´</span>'; };
        logoWrap.appendChild(img);
      } else {
        logoWrap.innerHTML = '<span id="logoIcon">üè´</span>';
      }
    }

    function saveCertificates(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(certificates));
      renderSavedList();
    }

    function renderSavedList(){
      savedList.innerHTML = '';
      if (!certificates.length){
        const li=document.createElement('li');
        li.className='list-group-item text-muted small';
        li.textContent='No saved certificates yet.';
        savedList.appendChild(li);
        return;
      }
      certificates.forEach((c, idx) => {
        const li=document.createElement('li');
        li.className='list-group-item d-flex justify-content-between align-items-center';

        const left=document.createElement('div'); left.className='d-flex align-items-center gap-2';
        const imgWrap=document.createElement('div');
        Object.assign(imgWrap.style, {width:'36px',height:'36px',borderRadius:'50%',overflow:'hidden',display:'flex',alignItems:'center',justifyContent:'center',background:'#f1f5f9'});

        if (c.logo){
          const im=document.createElement('img');
          im.src=c.logo;
          im.style.width='100%'; im.style.height='100%'; im.style.objectFit='cover';
          im.onerror=()=>{ imgWrap.textContent='üè´'; };
          imgWrap.appendChild(im);
        } else {
          imgWrap.textContent='üè´';
        }

        const txt=document.createElement('div');
        txt.innerHTML=`<div class='small fw-semibold'>${escapeHtml(c.student||c.platform||'Untitled')}</div><div class='small text-muted'>${escapeHtml(c.course||'')}</div>`;
        left.appendChild(imgWrap); left.appendChild(txt);

        const right=document.createElement('div');
        const previewBtn=document.createElement('button');
        previewBtn.type='button'; previewBtn.className='btn btn-sm btn-outline-primary me-1';
        previewBtn.textContent='Preview'; previewBtn.dataset.idx=idx;
        const delBtn=document.createElement('button');
        delBtn.type='button'; delBtn.className='btn btn-sm btn-outline-danger';
        delBtn.textContent='Delete'; delBtn.dataset.idx=idx;

        right.appendChild(previewBtn); right.appendChild(delBtn);

        li.appendChild(left); li.appendChild(right); savedList.appendChild(li);

        previewBtn.addEventListener('click', () => {
          const data = certificates[idx];
          platformEl.value = data.platform||'';
          logoEl.value = data.logo||'';
          instructorEl.value = data.instructor||'';
          studentEl.value = data.student||'';
          courseEl.value = data.course||'';
          dateEl.value = data.date||'';
          renderCertificate(data);
        });

        delBtn.addEventListener('click', () => {
          certificates.splice(idx,1);
          saveCertificates();
        });
      });
    }

    // Event handlers
    generateBtn.addEventListener('click', () => {
      const data = {
        platform: platformEl.value.trim(),
        logo: logoEl.value.trim(),
        instructor: instructorEl.value.trim(),
        student: studentEl.value.trim(),
        course: courseEl.value.trim(),
        date: dateEl.value.trim()
      };
      renderCertificate(data);
    });

    saveBtn.addEventListener('click', () => {
      const data = {
        platform: platformEl.value.trim(),
        logo: logoEl.value.trim(),
        instructor: instructorEl.value.trim(),
        student: studentEl.value.trim(),
        course: courseEl.value.trim(),
        date: dateEl.value.trim()
      };
      if(!data.student || !data.course){
        alert('Please provide at least a student name and course name before saving.');
        return;
      }
      certificates.unshift(data); saveCertificates(); alert('Saved to list');
    });

    clearStorage.addEventListener('click', () => {
      if(!confirm('Clear all saved certificates?')) return;
      certificates=[]; saveCertificates();
    });

    document.getElementById('downloadPdf').addEventListener('click', () => {
      if (typeof html2pdf === 'undefined'){
        alert('PDF export library not loaded. Check your network or CDN.');
        return;
      }
      const studentFileName = (studentEl.value || 'certificate').replace(/ /g, '_');
      const opt = {
        margin: 10,
        filename: studentFileName + '.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' }
      };
      html2pdf().set(opt).from(certificateCard).save();
    });

    // Safe print: clone node and open in new window without document.write of outerHTML
    document.getElementById('printBtn').addEventListener('click', () => {
      const printWindow = window.open('', '_blank', 'noopener');
      if(!printWindow){ alert('Popup blocked. Allow popups for this site to print.'); return; }

const doc = printWindow.document;

doc.open();
doc.close();

const meta = doc.createElement('meta');
meta.setAttribute('charset', 'utf-8');

const title = doc.createElement('title');
title.textContent = 'Print certificate';

doc.head.appendChild(meta);
doc.head.appendChild(title);

doc.body.style.margin = '0';
doc.body.style.padding = '24px';
doc.body.style.background = '#fff';


      // copy styles
      const head = printWindow.document.head;
      document.querySelectorAll('link[rel="stylesheet"], style').forEach(node => {
        try { head.appendChild(node.cloneNode(true)); } catch(e) {}
      });

      const clone = certificateCard.cloneNode(true);
      clone.querySelectorAll('button,input,textarea,a').forEach(el => el.remove());
      printWindow.document.body.appendChild(clone);

      const doPrint = () => {
        try { printWindow.focus(); printWindow.print(); } catch(err) { console.error('Print failed', err); }
      };
      // If the new window finishes loading, trigger print. Fallback call after 600ms.
      printWindow.onload = () => setTimeout(doPrint, 150);
      setTimeout(() => { if(!printWindow.closed) doPrint(); }, 600);
    });

    // init render
    renderSavedList();
    if(!certificates.length){
      const example = {
        platform: 'Apex Academy',
        logo: '',
        instructor: 'Dr. Sarah West',
        student: 'Alex Morgan',
        course: 'Frontend Developer ‚Äî Advanced',
        date: 'October 24, 2025'
      };
      renderCertificate(example);
    } else {
      renderCertificate(certificates[0]);
    }

  } catch (err) {
    console.error('Top-level script error:', err);
    alert('Script failed to start ‚Äî open devtools console to see the error.');
  }
});
</script>

</body>
</html>
